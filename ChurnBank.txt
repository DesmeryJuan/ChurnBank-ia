base=read.csv("ChurnBank.csv")
head(base)
str(base)
base$RowNumber=NULL
str(base)
base$CustomerId=NULL
str(base)
base$Surname=NULL
str(base)
base$Geography=as.factor(base$Geography)
str(base)
base$Gender=as.factor(base$Gender)
str(base)
library(caret)
set.seed(123);particion=createDataPartition(base$Exited,p=0.8,list=F)
entreno=base[particion,]
testeo=base[-particion,]
library(rpart)
arbol=rpart(Exited~.,entreno,method="class")
library(rpart.plot)
rpart.plot(arbol,extra=1,type=5)
arbolGrande=rpart(Exited~.,entreno,method="class",minsplit=0,cp=0)
rpart.plot(arbolGrande,type=5,extra=1)
x11();plotcp(arbolGrande)
podado3=prune(arbolGrande,cp=0.0034)
rpart.plot(podado3,type=5,extra=1)
